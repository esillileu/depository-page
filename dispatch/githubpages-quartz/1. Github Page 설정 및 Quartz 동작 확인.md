---
tags:
  - dispatch/depository
---
> 이전글 : [[0. Github Pages에 Quartz를 이용한 Obsidian 베포]]
---
# 서담
- 무료 호스팅인 관계로, 방법들을 잘 기억해두면 써먹을 곳이 많을거란 생각
- Quartz는 상당히 예뻐서, 적절한 커스터마이징 후 사용하면 될 듯
	- 로컬에 npm이 설치 되어있어야 함. 
- [[Github Pages 설정 방법#0. 제반 사항|제반사항]]의 내용 확인하면 이후 원활한 진행 가능


# 본담
## 과정
### 1. [[Github]] [[Repsitory|레포]] 생성
- [Quartz](https://github.com/jackyzha0/quartz) > Use this template > create a new repository - 우측 상단 녹색버튼
- 레포 생성 페이지
	- Include all branches: off - on 하면 불필요한 과거 브랜치도 가져와짐
	- Repository name 
		- 기본 도메인 - `https://<github_id>.github.io/<repo_name>` 
		- `<github_id}.github.io`로 이름 설정 시 - `https://<github_id>.github.io'
	- Choose visibility: public
		- private 레포는 유료 플랜이 있어야 페이지 배포 가능
	- create repository - 하단 녹색 버튼

### 2. 레포 편집
- 로컬에서 메인 브랜치를 만들어 개발 브랜치 안 겹치게 설정
	- 이후 업데이트 있을 시 수월한 병합을 위해
	- 진행을 위한 Git 코드 - 로컬에 Git 설치 및 설정이 되어있어야 함.
	```bash
	git clone https://github.com/<github_id>/<repo_name>.git
	cd <repo_name>
	git branch main v4
	git checkout main
	```
- 테스트를 위한 첫 페이지 추가 
	- 파일 경로: `<repo_name>/content/`
	- 파일 이름: `index.md`
	- 파일 내용
	```markdown
	---
	title: test
	---
	hello world
	```
- github page용 deploy 워크플로우를 폴더에 추가 
	- 파일 경로: `<repo_name>/.github/workflow/`
	- 파일 이름: `deploy.yml` 
	- 파일 내용
	```yaml
	name: Deploy Quartz site to GitHub Pages
	
	on:
	  push:
	    branches:
	      - main
	
	permissions:
	  contents: read
	  pages: write
	  id-token: write
	
	concurrency:
	  group: "pages"
	  cancel-in-progress: false
	
	jobs:
	  build:
	    runs-on: ubuntu-22.04
	    steps:
	      - uses: actions/checkout@v4
	        with:
	          submodules: recursive
	          fetch-depth: 0 # Fetch all history for git info
	      - uses: actions/setup-node@v4
	        with:
	          node-version: 22
	      - name: Install Dependencies
	        run: npm ci
	      - name: Build Quartz
	        run: npx quartz build
	      - name: Upload artifact
	        uses: actions/upload-pages-artifact@v3
	        with:
	          path: public
	
	  deploy:
	    needs: build
	    environment:
	      name: github-pages
	      url: ${{ steps.deployment.outputs.page_url }}
	    runs-on: ubuntu-latest
	    steps:
	      - name: Deploy to GitHub Pages
	        id: deployment
	        uses: actions/deploy-pages@v4
	```
- 전체 내용 푸시
```bash
git add .
git commit -m "add main branch"
git push origin main
```

### 3. Defualt 브랜치 변경 
+ 브랜치 적용
	+ Github 레포페이지 > compare & pull request - 녹색버튼
	+ Create pull request - 하단 녹색 버튼
	+ Merge pull request - 중앙 회색버튼, 잠시 기다려야 함 
		+ Github Action이 일부 실패하나, Pages 설정 안해서 그런거 문제 없음 
	+ Confirm - Merge pull request 있던 자리에
		+ 없으면 안해도 됨
- Github 레포페이지 > 설정(settings)
	- Default branch > switch(좌우 화살표) > main > update > I understand

### 4. [[Github Pages]] 설정
- 설정(settings) > 우측패널 > Code and automation > pages 
	- source: Github Action 

### 5. 페이지 발행
+ 로컬 쿼츠 빌드 및 싱크 - 프로젝트 루트 폴더에서
	```bash
	npm install 
	npx quartz build --serve # 로컬에서 사이트 확인. 종료(Ctrl+c)후에 아래 실행
	npx quartz sync 
	```


# 종담
- 이후 도메인으로 이동하면 페이지를 볼 수 있음
	- 기본 도메인 - `https://<github_id>.github.io/<repo_name>` 
	- `<github_id>.github.io`로 이름 설정 시 - `https://<github_id>.github.io'
- `.github/workflows`에 있는 yml파일을 Github에서 워크플로 인식해 등록
	- 워크플로우 속성 중에 jobs > deploy가 있으면 deployment에서 관리
	- 워크플로우에 지정 이름의 워크플로우 실행 결과를 확인하고 재시할 수 있음


# 한담
+ Github Action이랑 멀티 브랜치 관리 때문에 죽을 뻔함
	+ 처음 깃 배우는 느낌이었음
	+ 테스트 레포를 열 몇 개 만들어가며 과정을 정립함
	+ 앞으로는 진행 과정을 잘 정리해둬야할 듯
---
> 다음글 : [[2. Git Submodule 설정 및 내용 연동]]
